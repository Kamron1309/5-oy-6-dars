<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD & Task List App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4e54c8',
                        secondary: '#6a11cb',
                        accent: '#2575fc',
                        success: '#00b33c',
                        danger: '#ff4d4d',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            font-family: 'Inter', sans-serif;
        }

        .custom-checkbox {
            position: absolute;
            opacity: 0;
        }

        .custom-checkbox+label {
            position: relative;
            cursor: pointer;
            padding: 0;
            margin-bottom: 0;
        }

        .custom-checkbox+label:before {
            content: '';
            margin-right: 10px;
            display: inline-block;
            vertical-align: text-top;
            width: 20px;
            height: 20px;
            background: #f1f2f6;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .custom-checkbox:hover+label:before {
            background: #e2e6f3;
        }

        .custom-checkbox:checked+label:before {
            background: #4e54c8;
        }

        .custom-checkbox:checked+label:after {
            content: '';
            position: absolute;
            left: 5px;
            top: 9px;
            background: white;
            width: 2px;
            height: 2px;
            box-shadow:
                2px 0 0 white,
                4px 0 0 white,
                4px -2px 0 white,
                4px -4px 0 white,
                4px -6px 0 white,
                4px -8px 0 white;
            transform: rotate(45deg);
        }

        .custom-checkbox:checked~.task-text {
            text-decoration: line-through;
            color: #9ca3af;
        }

        .notification {
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .progress-bar {
            transition: width 0.5s ease;
        }

        .item-card {
            transition: transform 0.3s ease;
        }

        .item-card:hover {
            transform: translateY(-3px);
        }

        .api-btn {
            transition: all 0.3s ease;
        }

        .api-btn:hover {
            transform: translateY(-2px);
        }

        .skeleton {
            background-color: #eee;
            background-image: linear-gradient(90deg, #eee, #f5f5f5, #eee);
            background-size: 200px 100%;
            background-repeat: no-repeat;
            border-radius: 4px;
            display: inline-block;
            line-height: 1;
            width: 100%;
            height: 40px;
            margin-bottom: 10px;
            animation: skeleton-animation 1.5s ease-in-out infinite;
        }

        @keyframes skeleton-animation {
            0% {
                background-position: -200px 0;
            }

            100% {
                background-position: calc(200px + 100%) 0;
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-secondary to-accent min-h-screen p-4 md:p-6 flex items-center justify-center">
    <div class="w-full max-w-7xl bg-white rounded-xl shadow-2xl overflow-hidden">
        <!-- Header -->
        <header class="bg-primary text-white py-6 px-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">CRUD & Task List Application</h1>
            <p class="text-white/90">Create, Read, Update, Delete operations with a Task List manager</p>
        </header>

        <div class="flex flex-col lg:flex-row">
            <!-- CRUD Section -->
            <div class="w-full lg:w-1/2 p-6 border-r-0 lg:border-r border-gray-200">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">CRUD Operations</h2>

                <div class="mb-6">
                    <h3 class="text-lg font-medium text-gray-700 mb-3">New Item</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="title">Title</label>
                        <input type="text" id="title" placeholder="Enter title"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>

                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="description">Description</label>
                        <textarea id="description" placeholder="Enter description"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-28"></textarea>
                    </div>

                    <div class="flex items-center mb-6">
                        <input type="checkbox" id="completed"
                            class="mr-2 h-5 w-5 text-primary rounded focus:ring-primary">
                        <label for="completed" class="text-gray-700">Completed</label>
                    </div>

                    <button id="create-btn"
                        class="w-full bg-primary hover:bg-primary/90 text-white font-semibold py-3 rounded-lg transition-all duration-300 flex items-center justify-center">
                        <i class="fas fa-plus mr-2"></i> Create Item
                    </button>
                </div>

                <div>
                    <h3 class="text-lg font-medium text-gray-700 mb-3">API Actions:</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <button
                            class="api-btn bg-secondary hover:bg-secondary/90 text-white text-center py-3 rounded-lg cursor-pointer"
                            onclick="fetchItems()">
                            <i class="fas fa-download mr-2"></i> GET
                        </button>
                        <button
                            class="api-btn bg-secondary hover:bg-secondary/90 text-white text-center py-3 rounded-lg cursor-pointer"
                            onclick="createItem()">
                            <i class="fas fa-paper-plane mr-2"></i> POST
                        </button>
                        <button
                            class="api-btn bg-secondary hover:bg-secondary/90 text-white text-center py-3 rounded-lg cursor-pointer"
                            onclick="updateItem()">
                            <i class="fas fa-edit mr-2"></i> PUT
                        </button>
                        <button
                            class="api-btn bg-secondary hover:bg-secondary/90 text-white text-center py-3 rounded-lg cursor-pointer"
                            onclick="deleteItem()">
                            <i class="fas fa-trash mr-2"></i> DELETE
                        </button>
                    </div>
                </div>
            </div>

            <!-- Task List Section -->
            <div class="w-full lg:w-1/2 p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Task List</h2>

                <div class="mb-6">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Checklist Items</h3>

                    <ul class="task-list mb-8" id="task-list">
                        <!-- Tasks will be loaded here -->
                    </ul>

                    <div class="bg-gray-50 p-4 rounded-xl mb-6">
                        <h3 class="text-lg font-medium text-gray-700 mb-3">Progress</h3>
                        <div class="w-full bg-gray-200 rounded-full h-3 mb-2">
                            <div id="progress-bar"
                                class="progress-bar bg-gradient-to-r from-primary to-accent h-3 rounded-full"
                                style="width: 0%"></div>
                        </div>
                        <p id="progress-text" class="text-center font-semibold text-primary">0/0 tasks completed</p>
                    </div>

                    <div class="flex">
                        <input type="text" id="new-task-input" placeholder="Add a new task..."
                            class="flex-1 px-4 py-3 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <button id="add-task-btn"
                            class="bg-primary hover:bg-primary/90 text-white font-semibold px-5 rounded-r-lg transition-all duration-300">
                            Add
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Items List Section -->
        <div class="border-t border-gray-200 p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
                Items List
                <span class="ml-2 text-sm font-medium text-primary bg-primary/10 px-3 py-1 rounded-full"
                    id="items-count">0</span>
            </h2>

            <div class="items-list grid grid-cols-1 md:grid-cols-2 gap-4" id="items-list">
                <!-- Item cards will be displayed here -->
                <div class="col-span-2 text-center py-8 text-gray-500" id="no-items-message">
                    <i class="fas fa-inbox text-4xl mb-3"></i>
                    <p>No items found. Create your first item!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification fixed top-6 right-6 bg-primary text-white py-4 px-6 rounded-lg shadow-lg"
        id="notification">
        <i class="fas fa-check-circle mr-2"></i> Operation completed successfully!
    </div>

    <script>
        // API URL
        const API_URL = "https://68a44697c123272fb9b20d66.mockapi.io/example/todo";

        // Global variables
        let items = [];
        let currentEditId = null;

        // DOM Elements
        const itemsList = document.getElementById('items-list');
        const itemsCount = document.getElementById('items-count');
        const notification = document.getElementById('notification');
        const taskList = document.getElementById('task-list');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const noItemsMessage = document.getElementById('no-items-message');

        // Format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString();
        }

        // Show notification
        function showNotification(message, isError = false) {
            notification.innerHTML = `<i class="fas ${isError ? 'fa-exclamation-circle' : 'fa-check-circle'} mr-2"></i> ${message}`;

            if (isError) {
                notification.classList.add('bg-danger');
            } else {
                notification.classList.remove('bg-danger');
            }

            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Loading state
        function loading(isLoaded, element) {
            if (isLoaded) {
                element.innerHTML = '';
                Array.from({ length: 3 }).forEach(() => {
                    let skeleton = document.createElement('div');
                    skeleton.classList.add('skeleton');
                    element.appendChild(skeleton);
                });
            } else {
                element.innerHTML = '';
            }
        }

        // Get time for task creation
        function getTime() {
            let date = new Date();
            return `${date.getHours()}:${date.getMinutes()}`;
        }

        // Render items list
        function renderItems() {
            itemsCount.textContent = items.length;

            if (items.length === 0) {
                noItemsMessage.classList.remove('hidden');
                return;
            }

            noItemsMessage.classList.add('hidden');
            itemsList.innerHTML = '';

            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item-card bg-white border-l-4 border-primary rounded-lg p-4 shadow-md';
                itemElement.innerHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <div class="text-lg font-semibold text-primary ${item.completed ? 'line-through text-gray-500' : ''}">${item.title || item.text}</div>
                        <div class="flex space-x-2">
                            <button class="${item.completed ? 'text-success hover:text-success/80' : 'text-gray-400 hover:text-gray-600'}" onclick="toggleItem(${item.id})">
                                <i class="fas ${item.completed ? 'fa-undo' : 'fa-check'}"></i>
                            </button>
                            <button class="text-primary hover:text-primary/80" onclick="prepareEditItem(${item.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-danger hover:text-danger/80" onclick="deleteItem(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="text-gray-600 mb-3 ${item.completed ? 'line-through text-gray-500' : ''}">${item.description || 'No description'}</div>
                    <div class="flex justify-between text-sm text-gray-500 pt-3 border-t border-gray-100">
                        <div>Created: ${item.createdAt ? formatDate(item.createdAt) : item.time}</div>
                        <div>Updated: ${item.updatedAt ? formatDate(item.updatedAt) : (item.editTime || item.time)}</div>
                    </div>
                `;

                itemsList.appendChild(itemElement);
            });
        }

        // Render tasks
        function renderTasks() {
            taskList.innerHTML = '';

            if (items.length === 0) {
                const emptyMessage = document.createElement('li');
                emptyMessage.className = 'text-center py-6 text-gray-500';
                emptyMessage.innerHTML = '<i class="fas fa-tasks text-3xl mb-2"></i><p>No tasks yet. Add some tasks!</p>';
                taskList.appendChild(emptyMessage);
                return;
            }

            items.forEach(item => {
                const taskElement = document.createElement('li');
                taskElement.className = 'flex items-center justify-between py-3 border-b border-gray-200';
                taskElement.innerHTML = `
                    <div class="flex items-center">
                        <input type="checkbox" id="task-${item.id}" ${item.completed ? 'checked' : ''} class="custom-checkbox task-checkbox">
                        <label for="task-${item.id}" class="cursor-pointer"></label>
                        <span class="task-text ${item.completed ? 'line-through text-gray-500' : ''}">${item.title || item.text}</span>
                    </div>
                    <div class="flex space-x-2">
                        <button class="text-gray-500 hover:text-primary transition-colors" onclick="prepareEditItem(${item.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-gray-500 hover:text-danger transition-colors" onclick="deleteItem(${item.id})">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                `;

                taskList.appendChild(taskElement);
            });

            // Add event listeners to checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function () {
                    const id = this.id.split('-')[1];
                    toggleItem(id);
                });
            });

            updateProgress();
        }

        // Update progress bar
        function updateProgress() {
            const totalTasks = items.length;
            const completedTasks = items.filter(item => item.completed).length;
            const percentage = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;

            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${completedTasks}/${totalTasks} tasks completed`;
        }

        // Fetch items from API
        async function fetchItems() {
            try {
                loading(true, itemsList);
                const response = await fetch(API_URL);

                if (!response.ok) {
                    throw new Error('Failed to fetch items');
                }

                items = await response.json();
                renderItems();
                renderTasks();
                showNotification('Items fetched successfully!');
            } catch (error) {
                console.error('Error fetching items:', error);
                showNotification('Error fetching items: ' + error.message, true);
            }
        }

        // Create new item
        async function createItem() {
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const completed = document.getElementById('completed').checked;

            if (!title) {
                showNotification('Title is required!', true);
                return;
            }

            try {
                const newItem = {
                    text: title,
                    description: description,
                    completed: completed,
                    time: getTime(),
                    editTime: "",
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(newItem)
                });

                if (!response.ok) {
                    throw new Error('Failed to create item');
                }

                const createdItem = await response.json();
                items.push(createdItem);
                renderItems();
                renderTasks();

                // Clear form
                document.getElementById('title').value = '';
                document.getElementById('description').value = '';
                document.getElementById('completed').checked = false;

                showNotification('Item created successfully!');
            } catch (error) {
                console.error('Error creating item:', error);
                showNotification('Error creating item: ' + error.message, true);
            }
        }

        // Prepare item for editing
        function prepareEditItem(id) {
            const item = items.find(item => item.id == id);

            if (item) {
                document.getElementById('title').value = item.title || item.text;
                document.getElementById('description').value = item.description || '';
                document.getElementById('completed').checked = item.completed || false;

                currentEditId = id;
                showNotification('Item loaded for editing. Click "POST" to update.');
            }
        }

        // Update item
        async function updateItem() {
            if (!currentEditId) {
                showNotification('Please select an item to edit first', true);
                return;
            }

            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const completed = document.getElementById('completed').checked;

            if (!title) {
                showNotification('Title is required!', true);
                return;
            }

            try {
                const updatedItem = {
                    text: title,
                    description: description,
                    completed: completed,
                    editTime: getTime(),
                    updatedAt: new Date().toISOString()
                };

                const response = await fetch(`${API_URL}/${currentEditId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updatedItem)
                });

                if (!response.ok) {
                    throw new Error('Failed to update item');
                }

                const updatedItemData = await response.json();

                // Update local items array
                const index = items.findIndex(item => item.id == currentEditId);
                if (index !== -1) {
                    items[index] = updatedItemData;
                }

                renderItems();
                renderTasks();

                // Clear form and reset edit state
                document.getElementById('title').value = '';
                document.getElementById('description').value = '';
                document.getElementById('completed').checked = false;
                currentEditId = null;

                showNotification('Item updated successfully!');
            } catch (error) {
                console.error('Error updating item:', error);
                showNotification('Error updating item: ' + error.message, true);
            }
        }

        // Toggle item completion status
        async function toggleItem(id) {
            try {
                const item = items.find(item => item.id == id);
                if (!item) return;

                const updatedItem = {
                    ...item,
                    completed: !item.completed,
                    editTime: getTime(),
                    updatedAt: new Date().toISOString()
                };

                const response = await fetch(`${API_URL}/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updatedItem)
                });

                if (!response.ok) {
                    throw new Error('Failed to update item status');
                }

                const updatedItemData = await response.json();

                // Update local items array
                const index = items.findIndex(item => item.id == id);
                if (index !== -1) {
                    items[index] = updatedItemData;
                }

                renderItems();
                renderTasks();
                showNotification('Item status updated!');
            } catch (error) {
                console.error('Error toggling item:', error);
                showNotification('Error updating item status: ' + error.message, true);
            }
        }

        // Delete item
        async function deleteItem(id) {
            if (!confirm('Are you sure you want to delete this item?')) {
                return;
            }

            try {
                const response = await fetch(`${API_URL}/${id}`, {
                    method: 'DELETE'
                });

                if (!response.ok) {
                    throw new Error('Failed to delete item');
                }

                // Remove from local items array
                items = items.filter(item => item.id != id);
                renderItems();
                renderTasks();
                showNotification('Item deleted successfully!');
            } catch (error) {
                console.error('Error deleting item:', error);
                showNotification('Error deleting item: ' + error.message, true);
            }
        }

        // Add new task
        document.getElementById('add-task-btn').addEventListener('click', async function () {
            const taskInput = document.getElementById('new-task-input');
            const taskText = taskInput.value.trim();

            if (taskText) {
                try {
                    const newTask = {
                        text: taskText,
                        completed: false,
                        time: getTime(),
                        editTime: "",
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };

                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(newTask)
                    });

                    if (!response.ok) {
                        throw new Error('Failed to add task');
                    }

                    const createdTask = await response.json();
                    items.push(createdTask);
                    renderItems();
                    renderTasks();
                    taskInput.value = '';
                    showNotification('Task added successfully!');
                } catch (error) {
                    console.error('Error adding task:', error);
                    showNotification('Error adding task: ' + error.message, true);
                }
            }
        });

        // Allow adding task with Enter key
        document.getElementById('new-task-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                document.getElementById('add-task-btn').click();
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function () {
            fetchItems();
        });
    </script>
</body>

</html>